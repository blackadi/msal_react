(this["webpackJsonpmsal-react-quickstart"]=this["webpackJsonpmsal-react-quickstart"]||[]).push([[0],{14:function(e,c,t){},17:function(e,c,t){},18:function(e,c,t){"use strict";t.r(c);var n=t(1),s=t.n(n),r=t(7),i=t.n(r),a=(t(14),t(6)),o=t(9),j=t(3),l=t(2),u={auth:{clientId:"clientId from Azure AD app reg!",authority:"check microsoft docs for the right endpoint based on your app reg!",redirectUri:"URL to get the Code from auth server!"},cache:{cacheLocation:"sessionStorage",storeAuthStateInCookie:!1},system:{loggerOptions:{loggerCallback:function(e,c,t){if(!t)switch(e){case l.e.Error:return void console.error(c);case l.e.Info:return void console.info(c);case l.e.Verbose:return void console.debug(c);case l.e.Warning:return void console.warn(c)}}}}},d={scopes:["User.Read"]},h="Microsoft graph API URL",b=t(0),O=function(){var e=Object(j.e)().instance;return Object(b.jsxs)("button",{className:"ui red button",onClick:function(){e.loginPopup(d).catch((function(e){console.log(e)}))},children:[Object(b.jsx)("i",{className:"microsoft icon"}),"Sign In"]})},m=function(){var e=Object(j.e)().instance;return Object(b.jsx)("button",{className:"ui yellow button",onClick:function(){return e.logout()},children:"Sign Out"})},x=function(e){var c=Object(j.d)();return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)("div",{className:"ui inverted pointing menu",children:[Object(b.jsxs)("a",{href:"/",className:"item ",children:[Object(b.jsx)("i",{className:"react icon blue"}),"BlackAdi"]}),Object(b.jsxs)("div",{className:"right menu",children:[Object(b.jsx)("span",{className:"item",children:"MSAL Sample - Microsoft Identity Platform"}),c?Object(b.jsx)(m,{}):Object(b.jsx)(O,{})]})]}),Object(b.jsx)("h2",{children:Object(b.jsxs)("center",{children:["Welcome to the Land of OAuth - ",Object(b.jsx)("i",{className:"smile outline icon"})]})}),Object(b.jsx)("br",{}),Object(b.jsx)("br",{}),e.children]})},p=function(e){return console.log(e.graphData),Object(b.jsx)("div",{className:"ui people shape",children:Object(b.jsx)("div",{className:"sides",children:Object(b.jsx)("div",{className:"active side",children:Object(b.jsxs)("div",{className:"ui card red",style:{width:"100%"},children:[Object(b.jsx)("div",{class:"image",children:Object(b.jsx)("i",{className:"user icon"})}),Object(b.jsxs)("div",{class:"content",children:[Object(b.jsxs)("div",{class:"header",children:[Object(b.jsx)("i",{className:"microsoft icon"}),"Azure AD Profile Info"]}),Object(b.jsx)("br",{}),Object(b.jsxs)("div",{className:"description",children:[Object(b.jsxs)("p",{children:[Object(b.jsx)("strong",{children:"First Name: "})," ",e.graphData.givenName]}),Object(b.jsxs)("p",{children:[Object(b.jsx)("strong",{children:"Last Name: "})," ",e.graphData.surname]}),Object(b.jsxs)("p",{children:[Object(b.jsx)("strong",{children:"Email: "})," ",e.graphData.userPrincipalName]}),Object(b.jsxs)("p",{children:[Object(b.jsx)("strong",{children:"Mobile Phone: "})," ",e.graphData.mobilePhone]}),Object(b.jsxs)("p",{children:[Object(b.jsx)("strong",{children:"Id: "})," ",e.graphData.id]})]})]})]})})})})},f=t(5),g=t.n(f),v=t(8);function N(){return(N=Object(v.a)(g.a.mark((function e(c){var t,n,s;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new Headers,n="Bearer ".concat(c),t.append("Authorization",n),s={method:"GET",headers:t},e.abrupt("return",fetch(h,s).then((function(e){return e.json()})).catch((function(e){return console.log(e)})));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}t(17);var k=function(){var e=Object(j.e)(),c=e.instance,t=e.accounts,s=Object(n.useState)(null),r=Object(o.a)(s,2),i=r[0],l=r[1];return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)("h2",{className:"ui header brown",children:["Welcome ",t[0].name]}),i?Object(b.jsx)(p,{graphData:i}):Object(b.jsxs)("button",{className:"ui primary button",onClick:function(){c.acquireTokenSilent(Object(a.a)(Object(a.a)({},d),{},{account:t[0]})).then((function(e){(function(e){return N.apply(this,arguments)})(e.accessToken).then((function(e){return l(e)}))}))},children:[Object(b.jsx)("i",{className:"microsoft icon"}),"Get Profile Information"]})]})},w=function(){return Object(b.jsxs)("div",{className:"App",children:[Object(b.jsx)(j.a,{children:Object(b.jsx)(k,{})}),Object(b.jsx)(j.c,{children:Object(b.jsx)("div",{className:"ui container",children:Object(b.jsxs)("h5",{className:"ui floating message yellow",children:[Object(b.jsx)("i",{class:"sign-in icon"}),"Please sign-in to see your profile information."]})})})]})};function y(){return Object(b.jsx)(x,{children:Object(b.jsx)(w,{})})}var A=new l.g(u);i.a.render(Object(b.jsx)(s.a.StrictMode,{children:Object(b.jsx)(j.b,{instance:A,children:Object(b.jsx)(y,{})})}),document.getElementById("root"))}},[[18,1,2]]]);
//# sourceMappingURL=main.653a95be.chunk.js.map